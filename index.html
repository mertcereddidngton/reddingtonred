<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Kahve & Pipet Oyunu</title>

<style>
body{
  margin:0;
  height:100vh;
  background: url('background.jpg') center / cover no-repeat;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Arial, sans-serif;
}

#game{
  position:relative;
  width:360px;
  height:min(640px,90vh);
  background:black;
  border-radius:24px;
  overflow:hidden;
  box-shadow:0 20px 40px rgba(0,0,0,0.7);
}

#score{
  position:absolute;
  top:12px;
  left:16px;
  color:white;
  font-size:18px;
  z-index:10;
}

#cup{
  position:absolute;
  bottom:12px;
  left:50%;
  transform:translateX(-50%);
  width:72px;
  z-index:5;
  pointer-events:none;
}

.straw{
  position:absolute;
  top:-80px;
  width:60px;
  filter: drop-shadow(0 0 14px rgba(255,255,255,0.95));
  animation: fall linear forwards;
}

@keyframes fall{
  to{ top:700px; }
}

@keyframes pop{
  to{ transform:scale(2.5); opacity:0; }
}

#start{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.65);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  color:white;
  font-size:22px;
  z-index:20;
}

#start button{
  margin-top:20px;
  padding:14px 28px;
  font-size:18px;
  border:none;
  border-radius:14px;
  cursor:pointer;
}
</style>
</head>
<body>

<div id="game">
  <div id="score">Puan: 0 | Kaçan: 0</div>
  <img id="cup" src="cup.png">

  <div id="start">
    <div id="startText">Kahve Bardağı ile<br>Pipetleri Topla</div>
    <button id="startBtn">Başla</button>
  </div>
</div>

<script>
const game = document.getElementById('game');
const cup = document.getElementById('cup');
const scoreText = document.getElementById('score');
const startScreen = document.getElementById('start');
const startBtn = document.getElementById('startBtn');

let score = 0;
let misses = 0;
let running = false;
let spawnTimer;

startBtn.addEventListener('click', startGame);

function startGame(){
  score = 0;
  misses = 0;
  running = true;
  scoreText.textContent = 'Puan: 0 | Kaçan: 0';
  startScreen.style.display = 'none';
  clearTimeout(spawnTimer);
  spawnStraw();
}

function gameOver(){
  running = false;
  clearTimeout(spawnTimer);
  startScreen.style.display = 'flex';
  document.getElementById('startText').innerHTML = 'Oyun Bitti<br>Puan: '+score;
}

function spawnStraw(){
  if(!running) return;

  const straw = document.createElement('img');
  straw.src = 'straw.png';
  straw.className = 'straw';
  straw.style.left = Math.random() * (game.clientWidth - 60) + 'px';

  const speed = Math.max(1.8, 4 - score * 0.06);
  straw.style.animationDuration = speed + 's';

  game.appendChild(straw);

  const interval = setInterval(()=>{
    const s = straw.getBoundingClientRect();
    const c = cup.getBoundingClientRect();

    const d = Math.abs(s.bottom - c.top);
    straw.style.filter = `drop-shadow(0 0 ${Math.max(14,28-d/8)}px rgba(255,255,255,.95))`;

    if(s.bottom>c.top && s.left<c.right && s.right>c.left){
      score++;
      scoreText.textContent = `Puan: ${score} | Kaçan: ${misses}`;

      const flash=document.createElement('div');
      flash.style.position='absolute';
      flash.style.left=straw.offsetLeft+'px';
      flash.style.top=straw.offsetTop+'px';
      flash.style.width='50px';
      flash.style.height='50px';
      flash.style.borderRadius='50%';
      flash.style.background='white';
      flash.style.animation='pop .3s forwards';
      game.appendChild(flash);
      setTimeout(()=>flash.remove(),300);

      clearInterval(interval);
      straw.remove();
    }
  },40);

  setTimeout(()=>{
    if(straw.parentNode){
      misses++;
      scoreText.textContent = `Puan: ${score} | Kaçan: ${misses}`;
      if(misses>=10) gameOver();
      straw.remove();
    }
    clearInterval(interval);
  }, speed*1000);

  spawnTimer=setTimeout(spawnStraw,900);
}

addEventListener('mousemove',e=>{
  const r=game.getBoundingClientRect();
  let x=e.clientX-r.left;
  x=Math.max(20,Math.min(r.width-40,x));
  cup.style.left=x+'px';
});

addEventListener('touchmove',e=>{
  const r=game.getBoundingClientRect();
  let x=e.touches[0].clientX-r.left;
  x=Math.max(20,Math.min(r.width-40,x));
  cup.style.left=x+'px';
});
</script>

</body>
</html>